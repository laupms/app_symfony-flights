{% extends 'base.html.twig' %}

{% block title %}flights - Liste des compagnies aériennes{% endblock %}

{% block body %}

<section class="hero-airline">
    <div class="hero-airline-content">
        <h1>Compagnies aeriennes</h1>
    </div>
</section>

<div class="d-flex justify-content-between align-items-center mb-3 p-3">
    <div class="d-flex gap-3 mb-4">
        <select id="sortByAirline" class="form-select">
            <option value="az">Compagnie : A → Z</option>
            <option value="za">Compagnie : Z → A</option>
        </select>
    </div>
</div>

<section class="container pb-5">
    <div class="row justify-content-center">

        <div class="col-10">

            <table id="airlineTable" class="table">
                <thead style="border-style:hidden;">
                    <tr>
                        <th class="title-info">Logo</th>
                        <th class="title-info">Compagnie</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody>
                {% for airline in airlines %}
                    <tr data-name="{{ airline.name }}" style="vertical-align:middle;">
                        <td><img src="{{ asset('img/logo-airlines/' ~ airline.logo) }}" alt="{{ airline.name }}" width="100"></td>
                        <td>{{ airline.name }}</td>

                        <td class="d-flex actions">
                            <button class="btn edit-btn m-1 actions-size" title="Modifier">
                                <a href="{{ path('admin_airline_edit', {'id': airline.id}) }}" style="text-decoration:none; color:#ffffff;">
                                    <i class="fa-solid fa-pen-to-square"></i>
                                </a>
                            </button>

                            {{ include('admin/airline/_delete_form.html.twig') }}
                        </td>
                    </tr>
                    <tr class="spacer" style="height:50px;"></tr>

                {% else %}
                    <tr>
                        <td colspan="2" style="padding:30px;text-align:left;">Aucunes compagnies enregistrées !<br>Ajoutez-en une nouvelle ici <i class="fa-solid fa-turn-down" style="color: #000000;"></i></td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>

            <div class="btn-center">
                <a class="btn-slide slide-right" href="{{ path('admin_airline_new')}}" style="text-decoration:none;"><i class="fa-solid fa-plus p-2"></i>Créer une nouvelle compagnie</a>
            </div>
        </div>
    </div>
</section>

<script>
document.addEventListener('DOMContentLoaded', () => {
    const dataRows = Array.from(document.querySelectorAll('#airlineTable tbody tr[data-name]'));
    const tbody = document.querySelector('#airlineTable tbody');
    const sortByAirline = document.getElementById('sortByAirline');

    function updateTable() {
 
        tbody.classList.add('tr-fade');

        setTimeout(() => {
            let sortedRows = [...dataRows];

            sortedRows.sort((a, b) => {
                const airlineA = a.dataset.name.toLowerCase();
                const airlineB = b.dataset.name.toLowerCase();

                if (sortByAirline.value === 'az') {
                    return airlineA.localeCompare(airlineB);
                } else if (sortByAirline.value === 'za') {
                    return airlineB.localeCompare(airlineA);
                }

                return 0;
            });


            tbody.innerHTML = '';
            sortedRows.forEach((row) => {
                tbody.appendChild(row);
                const spacer = document.createElement('tr');
                spacer.classList.add('spacer');
                spacer.innerHTML = '<td colspan="3" style="height:50px;"></td>';
                tbody.appendChild(spacer);
            });

            tbody.classList.remove('tr-fade');
        }, 300);
    }

    sortByAirline.addEventListener('change', updateTable);
});
</script>


{% endblock %}
